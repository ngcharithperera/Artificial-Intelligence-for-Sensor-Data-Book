
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>19.1. Air Quality: Design Phase &#8212; Artificial Intelligence for Sensor Data Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/book.css?v=c89437f7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/semantic.css?v=830e9bb9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/semantic.min.css?v=afb28a0e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/accordion.css?v=cad30ddc" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/accordion.min.css?v=40149034" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/ad.css?v=fa50b361" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/ad.min.css?v=95913df9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/breadcrumb.css?v=5739848c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/breadcrumb.min.css?v=79aadc17" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/button.css?v=c2241dd5" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/button.min.css?v=854a7f65" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/card.css?v=2e9824ed" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/card.min.css?v=8ba12e58" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/checkbox.css?v=316aeaa6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/checkbox.min.css?v=d5afb107" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/comment.css?v=47089d3a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/comment.min.css?v=295ef65e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/container.css?v=6ff97f4f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/container.min.css?v=f6dddbf5" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/dimmer.css?v=33be1d40" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/dimmer.min.css?v=fdffbbb9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/divider.css?v=0edabdd3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/divider.min.css?v=38904780" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/dropdown.css?v=78a7e2bd" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/dropdown.min.css?v=1a9a7286" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/embed.css?v=24652adf" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/embed.min.css?v=6c5eac25" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/feed.css?v=90f476c7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/feed.min.css?v=90f35391" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/flag.css?v=5fc4064c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/flag.min.css?v=eb36a87b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/form.css?v=81137d3b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/form.min.css?v=3fa32edb" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/grid.css?v=d9615af7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/grid.min.css?v=7bba9fca" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/header.css?v=d43a982b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/header.min.css?v=1ef7df2e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/icon.css?v=79263a0b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/icon.min.css?v=2ccf357d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/image.css?v=16616cf7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/image.min.css?v=f9c564fe" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/input.css?v=1f879f9e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/input.min.css?v=2c04fc09" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/item.css?v=22bde7c1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/item.min.css?v=2189b086" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/label.css?v=475229dc" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/label.min.css?v=3e2b6ea9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/list.css?v=098eb3a7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/list.min.css?v=3ad5211a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/loader.css?v=bad70034" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/loader.min.css?v=a6e77407" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/menu.css?v=ab056a8e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/menu.min.css?v=610f144e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/message.css?v=bb19956b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/message.min.css?v=9acc0826" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/modal.css?v=7b5ae791" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/modal.min.css?v=c94cb040" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/nag.css?v=9ac353a3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/nag.min.css?v=d8329a6a" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/placeholder.css?v=3b423125" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/placeholder.min.css?v=f8ca56ea" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/popup.css?v=6f1a8499" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/popup.min.css?v=8113fdf0" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/progress.css?v=f3abbab5" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/progress.min.css?v=047aa4e8" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/rail.css?v=6421d114" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/rail.min.css?v=2688431b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/rating.css?v=1f155800" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/rating.min.css?v=5dbc9695" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/reset.css?v=5b3d0c18" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/reset.min.css?v=30ba6a20" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/reveal.css?v=5a29e3e0" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/reveal.min.css?v=984d9579" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/search.css?v=f30f9c44" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/search.min.css?v=bd5cad2f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/segment.css?v=be6c8852" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/segment.min.css?v=22aaa6f3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/shape.css?v=be1111ac" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/shape.min.css?v=7eb80a96" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/sidebar.css?v=4e2c2d9b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/sidebar.min.css?v=169a12f9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/site.css?v=1696f30b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/site.min.css?v=56e3a2d7" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/statistic.css?v=b81340ea" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/statistic.min.css?v=e5ea2662" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/step.css?v=a4b2d8ba" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/step.min.css?v=5afc1061" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/sticky.css?v=4cb79b47" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/sticky.min.css?v=a0b994bb" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/tab.css?v=cc5d746e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/tab.min.css?v=35794b9b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/table.css?v=2358d186" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/table.min.css?v=75e1aaca" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/transition.css?v=e54b488c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/transition.min.css?v=fe3203a3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/video.css?v=62ba6f73" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/semantic/components/video.min.css?v=5db097c6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-148221575-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-148221575-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase';</script>
    <script src="../../../../_static/semantic/package.js?v=54a2ae00"></script>
    <script src="../../../../_static/semantic/semantic.js?v=5cc25d9b"></script>
    <script src="../../../../_static/semantic/semantic.min.js?v=cdda0d68"></script>
    <script src="../../../../_static/semantic/components/accordion.js?v=6cf75f3e"></script>
    <script src="../../../../_static/semantic/components/accordion.min.js?v=b346d0ab"></script>
    <script src="../../../../_static/semantic/components/api.js?v=c268d94b"></script>
    <script src="../../../../_static/semantic/components/api.min.js?v=03eed511"></script>
    <script src="../../../../_static/semantic/components/checkbox.js?v=35765168"></script>
    <script src="../../../../_static/semantic/components/checkbox.min.js?v=1de544b7"></script>
    <script src="../../../../_static/semantic/components/colorize.js?v=e4e91489"></script>
    <script src="../../../../_static/semantic/components/colorize.min.js?v=e3ad593f"></script>
    <script src="../../../../_static/semantic/components/dimmer.js?v=47a9a3d6"></script>
    <script src="../../../../_static/semantic/components/dimmer.min.js?v=a12bf28d"></script>
    <script src="../../../../_static/semantic/components/dropdown.js?v=5fe041e7"></script>
    <script src="../../../../_static/semantic/components/dropdown.min.js?v=01c66ba4"></script>
    <script src="../../../../_static/semantic/components/embed.js?v=d66119e9"></script>
    <script src="../../../../_static/semantic/components/embed.min.js?v=4d7c283b"></script>
    <script src="../../../../_static/semantic/components/form.js?v=e5d4164a"></script>
    <script src="../../../../_static/semantic/components/form.min.js?v=c643ca1d"></script>
    <script src="../../../../_static/semantic/components/modal.js?v=5917cd06"></script>
    <script src="../../../../_static/semantic/components/modal.min.js?v=bc86a3d9"></script>
    <script src="../../../../_static/semantic/components/nag.js?v=76ee24dd"></script>
    <script src="../../../../_static/semantic/components/nag.min.js?v=becda8c6"></script>
    <script src="../../../../_static/semantic/components/popup.js?v=b9a09f0b"></script>
    <script src="../../../../_static/semantic/components/popup.min.js?v=06ade404"></script>
    <script src="../../../../_static/semantic/components/progress.js?v=9a633088"></script>
    <script src="../../../../_static/semantic/components/progress.min.js?v=4ca6e087"></script>
    <script src="../../../../_static/semantic/components/rating.js?v=e9201f97"></script>
    <script src="../../../../_static/semantic/components/rating.min.js?v=b1f4bfbe"></script>
    <script src="../../../../_static/semantic/components/search.js?v=9fb74436"></script>
    <script src="../../../../_static/semantic/components/search.min.js?v=87079b39"></script>
    <script src="../../../../_static/semantic/components/shape.js?v=0307e753"></script>
    <script src="../../../../_static/semantic/components/shape.min.js?v=1d3f04d9"></script>
    <script src="../../../../_static/semantic/components/sidebar.js?v=b693a0ad"></script>
    <script src="../../../../_static/semantic/components/sidebar.min.js?v=c59a5dc0"></script>
    <script src="../../../../_static/semantic/components/site.js?v=f4ba7019"></script>
    <script src="../../../../_static/semantic/components/site.min.js?v=d80d2ebb"></script>
    <script src="../../../../_static/semantic/components/state.js?v=55021597"></script>
    <script src="../../../../_static/semantic/components/state.min.js?v=a2a5cc59"></script>
    <script src="../../../../_static/semantic/components/sticky.js?v=f590cdae"></script>
    <script src="../../../../_static/semantic/components/sticky.min.js?v=27c980fa"></script>
    <script src="../../../../_static/semantic/components/tab.js?v=7b24c543"></script>
    <script src="../../../../_static/semantic/components/tab.min.js?v=d5b49a4a"></script>
    <script src="../../../../_static/semantic/components/transition.js?v=ba2de852"></script>
    <script src="../../../../_static/semantic/components/transition.min.js?v=74600979"></script>
    <script src="../../../../_static/semantic/components/video.js?v=dd17c20b"></script>
    <script src="../../../../_static/semantic/components/video.min.js?v=759065ab"></script>
    <script src="../../../../_static/semantic/components/visibility.js?v=da89e3b6"></script>
    <script src="../../../../_static/semantic/components/visibility.min.js?v=5c820967"></script>
    <script src="../../../../_static/semantic/components/visit.js?v=e5cc07e9"></script>
    <script src="../../../../_static/semantic/components/visit.min.js?v=d4df951d"></script>
    <link rel="canonical" href="https://inferentialthinking.org/parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase.html" />
    <link rel="icon" href="../../../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="20. Chapter Title" href="../../C2/chapter.html" />
    <link rel="prev" title="19. Applications and Sensors" href="../chapter.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/favicon.png" class="logo__image only-light" alt="Artificial Intelligence for Sensor Data Book - Home"/>
    <script>document.write(`<img src="../../../../_static/favicon.png" class="logo__image only-dark" alt="Artificial Intelligence for Sensor Data Book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I: Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part01/C1/chapter.html">1. Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part01/C1/S1/section.html">1.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part01/C2/chapter.html">2. Application Domains</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II: Theory and Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part02/C1/chapter.html">3. Theory 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part02/C1/S1/section.html">3.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part02/C2/chapter.html">4. Theory 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III: Physical Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part03/C1/chapter.html">5. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part03/C1/S1/section.html">5.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part03/C2/chapter.html">6. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV: Acoustic Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part04/C1/chapter.html">7. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part04/C1/S1/section.html">7.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part04/C2/chapter.html">8. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV: Optical Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part05/C1/chapter.html">9. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../part05/C1/S1/section.html">9.1. Section Title</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../part05/C1/S2/section.html">9.1.1. Section Title</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part05/C2/chapter.html">10. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part V: Magnetic Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part06/C1/chapter.html">11. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part06/C1/S1/section.html">11.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part06/C2/chapter.html">12. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VI: Magnetic Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part07/C1/chapter.html">13. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part07/C1/S1/section.html">13.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part07/C2/chapter.html">14. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VIII: Biological Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part08/C1/chapter.html">15. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part08/C1/S1/section.html">15.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part08/C2/chapter.html">16. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IX: Chemical Sensors</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part09/C1/chapter.html">17. Tutorial 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../part09/C1/S1/section.html">17.1. Section Title</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../part09/C2/chapter.html">18. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part X: Environmental Sensors</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../chapter.html">19. Estimating Air Pollution in Colombia</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">19.1. Air Quality: Design Phase</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../C2/chapter.html">20. Tutorial 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../part0X/intro.html">Chapter Name</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../part0X/C1/intro.html">Section Intro</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../part0X/C1/S1/section-1.html">Section 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../part0X/C1/S2/section-2.html">Section 2</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ngcharithperera/Artificial-Intelligence-for-Sensor-Data-Book/main?urlpath=lab/tree/parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/ngcharithperera/Artificial-Intelligence-for-Sensor-Data-Book&urlpath=lab/tree/Artificial-Intelligence-for-Sensor-Data-Book/parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/ngcharithperera/Artificial-Intelligence-for-Sensor-Data-Book/blob/main/parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/ngcharithperera/Artificial-Intelligence-for-Sensor-Data-Book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/parts/part10/C1/AirQualityDesignPhase/Air_Quality_Design_Phase.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Air Quality: Design Phase</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">19.1.1. Import Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">19.1.2. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-location-latitude-and-longitude-of-sensor-stations-to-the-dataframe">19.1.3. Add location (latitude and longitude of sensor stations) to the dataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-extent-and-distribution-of-missing-data">19.1.4. Visualize the extent and distribution of missing data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-null-values">19.1.4.1. 4.1 Count null values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-missing-data-in-a-time-series">19.1.4.2. 4.2 Visualize missing data in a time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-distribution-of-gaps-in-the-data">19.1.4.3. 4.3 Visualize the distribution of gaps in the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-simple-methods-for-estimating-missing-values">19.1.5. Visualize simple methods for estimating missing values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-nearest-neighbor-method-to-establish-a-baseline">19.1.6. 6. Run the nearest neighbor method to establish a baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-data-to-train-a-neural-network-model">19.1.7. 7. Prepare the data to train a neural network model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-missing-values-and-add-columns-for-later-use-with-a-neural-network-model">19.1.7.1. 7.1. Remove missing values and add columns for later use with a neural network model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-into-training-and-testing-sets">19.1.7.2. 7.2 Split data into training and testing sets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-and-test-a-neural-network-model-for-estimating-missing-data">19.1.8. 8. Train and test a neural network model for estimating missing data.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results-from-your-baseline-model-compared-to-the-neural-network">19.1.9. 9. Visualize the results from your baseline model compared to the neural network.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-missing-sensor-measurements-across-all-pollutants">19.1.10. 10. Estimate missing sensor measurements across all pollutants.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results-of-filling-in-missing-pm2-5-values">19.1.11. 11. Visualize the results of filling in missing PM2.5 values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-write-the-resulting-dataset-to-a-new-csv-file">19.1.12. 12. Optional: write the resulting dataset to a new csv file</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="air-quality-design-phase">
<h1><span class="section-number">19.1. </span>Air Quality: Design Phase<a class="headerlink" href="#air-quality-design-phase" title="Link to this heading">#</a></h1>
<p>Welcome to the second lab of this course. Last week, you used exploratory data analysis to gain insight into the Bogotá air quality data obtained from the <a class="reference external" href="http://201.245.192.252:81/home/map">RMCAB</a>. In this notebook, you will work on the next stage of your project: designing your solution.</p>
<p>Here are the steps you will complete in this notebook:</p>
<ol class="arabic simple">
<li><p>Import Python packages</p></li>
<li><p>Load the data</p></li>
<li><p>Add location (latitude and longitude of sensor stations) to the dataframe</p></li>
<li><p>Visualize the extent and distribution of missing data</p></li>
<li><p>Visualize simple methods for estimating missing values</p></li>
<li><p>Run the nearest neighbor method to establish a baseline</p></li>
<li><p>Prepare the data to train a neural network model</p></li>
<li><p>Train and test a neural network model for estimating missing values</p></li>
<li><p>Visualize the results from your baseline model compared to the neural network</p></li>
<li><p>Estimate missing sensor measurements across all pollutants</p></li>
<li><p>Visualize the results of filling in missing PM2.5 values</p></li>
<li><p>Optional: write the resulting dataset to a new csv file</p></li>
</ol>
<section id="import-python-packages">
<h2><span class="section-number">19.1.1. </span>Import Python packages<a class="headerlink" href="#import-python-packages" title="Link to this heading">#</a></h2>
<p>Run the next cell to import the Python packages you’ll be using in this lab exercise. If everything goes well you should see a message when the cell has finished running that says “All packages imported successfully!”.</p>
<p>Note the <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">utils</span></code> line. This line imports the functions that were specifically written for this lab. If you want to look at what these functions are, go to <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">-&gt;</span> <span class="pre">Open...</span></code> and open the <code class="docutils literal notranslate"><span class="pre">utils.py</span></code> file to have a look.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This is an example
This is a Smaple Message</p>
</div>
<div class="ui red segment">Red</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># package for reading in and manipulating data</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="c1"># package for manipulating dates</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1"># package for splitting data</span>

<span class="kn">import</span> <span class="nn">utils</span> <span class="c1"># utility functions defined for this lab</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All packages imported successfully!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All packages imported successfully!
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-data">
<h2><span class="section-number">19.1.2. </span>Load the data<a class="headerlink" href="#load-the-data" title="Link to this heading">#</a></h2>
<p>Run the next cell to load the Bogotá air quality data. This is the same step you took in the previous lab, where you are using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package to read the csv file containing the data into a “dataframe” called <code class="docutils literal notranslate"><span class="pre">raw_data</span></code>, then modifying some of the column names and formats, and printing out the first five lines of the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the data</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/RMCAB_air_quality_sensor_data.csv&#39;</span><span class="p">)</span>
<span class="c1"># Modify the DateTime column format</span>
<span class="n">raw_data</span><span class="p">[</span><span class="s1">&#39;DateTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">fix_dates</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="s1">&#39;DateTime&#39;</span><span class="p">),</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Rename columns from Spanish to English</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;OZONO&#39;</span><span class="p">:</span> <span class="s1">&#39;OZONE&#39;</span><span class="p">})</span>
<span class="c1"># print out the number of rows in the dataframe</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The dataset contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> entries&quot;</span><span class="p">)</span>
<span class="c1"># Print out the first few lines in the dataframe</span>
<span class="n">raw_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The dataset contains 166440 entries
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM10</th>
      <th>PM2.5</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>CO</th>
      <th>OZONE</th>
      <th>Station</th>
      <th>DateTime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56.6</td>
      <td>32.7</td>
      <td>7.504</td>
      <td>15.962</td>
      <td>23.493</td>
      <td>0.44924</td>
      <td>2.431</td>
      <td>USM</td>
      <td>2021-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>59.3</td>
      <td>39.3</td>
      <td>16.560</td>
      <td>17.866</td>
      <td>34.426</td>
      <td>0.69832</td>
      <td>1.121</td>
      <td>USM</td>
      <td>2021-01-01 01:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>96.4</td>
      <td>70.8</td>
      <td>22.989</td>
      <td>17.802</td>
      <td>40.791</td>
      <td>0.88243</td>
      <td>1.172</td>
      <td>USM</td>
      <td>2021-01-01 02:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>108.3</td>
      <td>81.0</td>
      <td>3.704</td>
      <td>9.886</td>
      <td>13.591</td>
      <td>0.29549</td>
      <td>6.565</td>
      <td>USM</td>
      <td>2021-01-01 03:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.7</td>
      <td>56.1</td>
      <td>2.098</td>
      <td>9.272</td>
      <td>11.371</td>
      <td>0.16621</td>
      <td>9.513</td>
      <td>USM</td>
      <td>2021-01-01 04:00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="add-location-latitude-and-longitude-of-sensor-stations-to-the-dataframe">
<h2><span class="section-number">19.1.3. </span>Add location (latitude and longitude of sensor stations) to the dataframe<a class="headerlink" href="#add-location-latitude-and-longitude-of-sensor-stations-to-the-dataframe" title="Link to this heading">#</a></h2>
<p>Run the next cell to read in another dataset containing the location of each sensor station and then add those locations as new columns to your air pollution dataset.</p>
<p><strong>Note:</strong> the data used here to add the location of each station includes column names in Spanish such as <code class="docutils literal notranslate"><span class="pre">Sigla</span></code> (initials), <code class="docutils literal notranslate"><span class="pre">Latitud</span></code> (latitude), <code class="docutils literal notranslate"><span class="pre">Longitud</span></code> (longitude), and with the next cell you’re also renaming those columns to their English equivalent (with “station” instead of “intials”).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in csv file containing location data and format appropriately</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/stations_loc.csv&#39;</span><span class="p">)</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">stations</span><span class="p">[[</span><span class="s1">&#39;Sigla&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitud&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitud&#39;</span><span class="p">]]</span>
<span class="c1"># Rename the columns from Spanish to English</span>
<span class="n">stations</span> <span class="o">=</span> <span class="n">stations</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Sigla&#39;</span><span class="p">:</span> <span class="s1">&#39;Station&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitud&#39;</span><span class="p">:</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Longitud&#39;</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">})</span>
<span class="c1"># Parse the dates</span>
<span class="n">stations</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stations</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">parse_dms</span><span class="p">)</span>
<span class="n">stations</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stations</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">parse_dms</span><span class="p">)</span>
<span class="c1"># Add location data as extra columns to air pollution dataset</span>
<span class="n">raw_data_enriched</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">stations</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Station&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">raw_data_enriched</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PM10</th>
      <th>PM2.5</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>CO</th>
      <th>OZONE</th>
      <th>Station</th>
      <th>DateTime</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56.6</td>
      <td>32.7</td>
      <td>7.504</td>
      <td>15.962</td>
      <td>23.493</td>
      <td>0.44924</td>
      <td>2.431</td>
      <td>USM</td>
      <td>2021-01-01 00:00:00</td>
      <td>4.532056</td>
      <td>-74.117139</td>
    </tr>
    <tr>
      <th>1</th>
      <td>59.3</td>
      <td>39.3</td>
      <td>16.560</td>
      <td>17.866</td>
      <td>34.426</td>
      <td>0.69832</td>
      <td>1.121</td>
      <td>USM</td>
      <td>2021-01-01 01:00:00</td>
      <td>4.532056</td>
      <td>-74.117139</td>
    </tr>
    <tr>
      <th>2</th>
      <td>96.4</td>
      <td>70.8</td>
      <td>22.989</td>
      <td>17.802</td>
      <td>40.791</td>
      <td>0.88243</td>
      <td>1.172</td>
      <td>USM</td>
      <td>2021-01-01 02:00:00</td>
      <td>4.532056</td>
      <td>-74.117139</td>
    </tr>
    <tr>
      <th>3</th>
      <td>108.3</td>
      <td>81.0</td>
      <td>3.704</td>
      <td>9.886</td>
      <td>13.591</td>
      <td>0.29549</td>
      <td>6.565</td>
      <td>USM</td>
      <td>2021-01-01 03:00:00</td>
      <td>4.532056</td>
      <td>-74.117139</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.7</td>
      <td>56.1</td>
      <td>2.098</td>
      <td>9.272</td>
      <td>11.371</td>
      <td>0.16621</td>
      <td>9.513</td>
      <td>USM</td>
      <td>2021-01-01 04:00:00</td>
      <td>4.532056</td>
      <td>-74.117139</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="visualize-the-extent-and-distribution-of-missing-data">
<h2><span class="section-number">19.1.4. </span>Visualize the extent and distribution of missing data<a class="headerlink" href="#visualize-the-extent-and-distribution-of-missing-data" title="Link to this heading">#</a></h2>
<section id="count-null-values">
<h3><span class="section-number">19.1.4.1. </span>4.1 Count null values<a class="headerlink" href="#count-null-values" title="Link to this heading">#</a></h3>
<p>Run the next cell to perform the null value count you did in the last notebook as a reminder of how many missing values there are in each column of your dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out a count of missing data for each column in the dataset</span>
<span class="n">raw_data_enriched</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PM10         20014
PM2.5        15312
NO           27664
NO2          27662
NOX          27668
CO           31238
OZONE        32132
Station          0
DateTime         0
Latitude         0
Longitude        0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-missing-data-in-a-time-series">
<h3><span class="section-number">19.1.4.2. </span>4.2 Visualize missing data in a time series<a class="headerlink" href="#visualize-missing-data-in-a-time-series" title="Link to this heading">#</a></h3>
<p>Run the cell below to generate the same plot you saw near the end of the last lab, namely, pollutant values over time as measured at a particular sensor station. You can use the pulldown menus to choose different stations and pollutants. You can also use the sliders to zoom in or out on a particular range of dates. You can edit the <code class="docutils literal notranslate"><span class="pre">start_date</span></code> and <code class="docutils literal notranslate"><span class="pre">end_date</span></code> values and run the code cell again to start with a different date range.</p>
<p>Try looking at different pollutants as well as different dates and sensor stations to investigate the size of gaps in the data. Note that because you have missing data, for some combinations of parameters there may be no points on your plot!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a time series for a particular date range, pollutant, and sensor station</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">create_time_series_plot</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "19f0e577712348189e0ef0668dc48632", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="visualize-the-distribution-of-gaps-in-the-data">
<h3><span class="section-number">19.1.4.3. </span>4.3 Visualize the distribution of gaps in the data<a class="headerlink" href="#visualize-the-distribution-of-gaps-in-the-data" title="Link to this heading">#</a></h3>
<p>Run the next cell to plot a count of gap size in hours (horizontal axis) vs. number of missing data points due to gaps of that size (vertical axis). With this plot you can get a sense of how different sized gaps in the data are contributing to your missing data problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the distribution of gap sizes in the data</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_distribution_of_gaps</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;PM2.5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/0c3f9de7361f2f8624d311fd86dba4306c467b766a85ce1bc040e53325eae723.png" src="../../../../_images/0c3f9de7361f2f8624d311fd86dba4306c467b766a85ce1bc040e53325eae723.png" />
</div>
</div>
</section>
</section>
<section id="visualize-simple-methods-for-estimating-missing-values">
<h2><span class="section-number">19.1.5. </span>Visualize simple methods for estimating missing values<a class="headerlink" href="#visualize-simple-methods-for-estimating-missing-values" title="Link to this heading">#</a></h2>
<p>Perhaps the most straightforward way to estimate missing value in your data is to simply take the last known value in the series and use it to replace the missing value. Another option would be to use a current measurement from the nearest station (nearest neighbor method).</p>
<p>Run the next cell to generate a visualization of the result of filling in missing values with either the last known value or the nearest neighbor method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the date to plot</span>
<span class="n">day</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="c1"># Create a plot to display the linear interpolation for a range of hours</span>
<span class="n">utils</span><span class="o">.</span><span class="n">visualize_missing_values_estimation</span><span class="p">(</span><span class="n">raw_data_enriched</span><span class="p">,</span> <span class="n">day</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7655a7b274634e4194f6b6896c9e27a5", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="run-the-nearest-neighbor-method-to-establish-a-baseline">
<h2><span class="section-number">19.1.6. </span>6. Run the nearest neighbor method to establish a baseline<a class="headerlink" href="#run-the-nearest-neighbor-method-to-establish-a-baseline" title="Link to this heading">#</a></h2>
<p>With the next cell, you’ll run your nearest neighbor model on simulated gaps in the PM2.5 data. The distribution of gaps you’ll be testing your model on here is simulated to be similar to the distribution in the real data. In principle, the size of the gaps shouldn’t matter for this method but you’ll simulate the real distribution for consistency with the actual data.</p>
<p>You’ll compute the accuracy of your baseline model by computing the <a class="reference external" href="https://en.wikipedia.org/wiki/Mean_absolute_error">Mean Absolute Error (MAE)</a>. The MAE is just the average difference between your model output and the ground truth, in this case for PM2.5.</p>
<div class="math notranslate nohighlight">
\[MAE = \frac{1}{n} \sum_{i=1}^{n}{|\rm{actual}_i - \rm{model}_i|}\]</div>
<p>Where “n” is the number of samples in the test dataset</p>
<p>Keep in mind that MAE is just one potential error metric you could choose to evaluate your model and, in practice, you might choose a different one (like mean squared error for example) depending on how your want to measure performance and what you aim to use your model for. Here we’re using MAE because it is a simple and intuitive measurement model performance, where the error estimate is in the units of the thing you’re trying to estimate, in this case, PM2.5 levels in micrograms / <span class="math notranslate nohighlight">\(\rm{m}^3\)</span>.</p>
<p>Run the next cell to test the nearest neighbor method and compute MAE.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a nearest neighbor model and run it on your test data</span>
<span class="n">regression_scores</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">regression_scores</span><span class="p">[</span><span class="s1">&#39;baseline_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">calculate_mae_for_nearest_station</span><span class="p">(</span><span class="n">raw_data_enriched</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;PM2.5&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regression_scores</span><span class="p">[</span><span class="s1">&#39;baseline_model&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;MAE&#39;: 8.035857704059362}
</pre></div>
</div>
</div>
</div>
</section>
<section id="prepare-the-data-to-train-a-neural-network-model">
<h2><span class="section-number">19.1.7. </span>7. Prepare the data to train a neural network model<a class="headerlink" href="#prepare-the-data-to-train-a-neural-network-model" title="Link to this heading">#</a></h2>
<p>Now that you have established a baseline, you’ll prepare your dataset to train and test a neural network model for estimating missing PM2.5 values.</p>
<section id="remove-missing-values-and-add-columns-for-later-use-with-a-neural-network-model">
<h3><span class="section-number">19.1.7.1. </span>7.1. Remove missing values and add columns for later use with a neural network model<a class="headerlink" href="#remove-missing-values-and-add-columns-for-later-use-with-a-neural-network-model" title="Link to this heading">#</a></h3>
<p>To do this, you’ll first remove all rows with missing values from the original dataset and then simulate gaps of different sizes in order to test your model. Before removing rows with missing values, you’ll also add some extra columns to your dataset to prepare for training a neural network model. These new columns include day of the week (<code class="docutils literal notranslate"><span class="pre">day_week</span></code>) and hour of day (<code class="docutils literal notranslate"><span class="pre">hour</span></code>). The line of code defining the variable <code class="docutils literal notranslate"><span class="pre">one_hot</span></code> is converting station ID to a numerical representation to indicate which station each measurement is from.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the variable you want to predict</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;PM2.5&#39;</span>

<span class="c1"># Create new columns for day of week and hour of day</span>
<span class="n">raw_data_for_imputing</span> <span class="o">=</span> <span class="n">raw_data_enriched</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">raw_data_for_imputing</span><span class="p">[</span><span class="s1">&#39;day_week&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">raw_data_for_imputing</span><span class="p">[</span><span class="s1">&#39;DateTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">weekday</span>
<span class="n">raw_data_for_imputing</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">(</span><span class="n">raw_data_for_imputing</span><span class="p">[</span><span class="s1">&#39;DateTime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">hour</span>

<span class="c1"># Create a numerical representation of station ID and add as extra columns to the dataframe</span>
<span class="n">one_hot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">raw_data_for_imputing</span><span class="o">.</span><span class="n">Station</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;Station&#39;</span><span class="p">)</span>
<span class="n">raw_data_for_imputing</span> <span class="o">=</span> <span class="n">raw_data_for_imputing</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">one_hot</span><span class="p">)</span>

<span class="c1"># Make a copy of the dataframe before dropping rows with missing values</span>
<span class="n">data_no_missing</span> <span class="o">=</span> <span class="n">raw_data_for_imputing</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  
<span class="c1"># Drop all rows containing missing values</span>
<span class="n">data_no_missing</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Print out the number of missing values in the PM2.5 column as a check (should print 0)</span>
<span class="n">null_remaining</span> <span class="o">=</span> <span class="n">data_no_missing</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">if</span> <span class="n">null_remaining</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;missing values removed and data prepared successfully!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>missing values removed and data prepared successfully!
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-data-into-training-and-testing-sets">
<h3><span class="section-number">19.1.7.2. </span>7.2 Split data into training and testing sets<a class="headerlink" href="#split-data-into-training-and-testing-sets" title="Link to this heading">#</a></h3>
<p>In order to compare your baseline model to a neural network model, it’s important to run your test on the same subset of the data. At this step, you’ll separate out a testing dataset and use that to your baseline model and compare to your neural network model.</p>
<img src="img/split_data.png" alt="split_data" width="400"/>
<center><b>Figure 1:</b> Splitting data into training and testing sets </center>
<p>Run the next cell to separate out 20% of your data for testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_no_missing</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">57</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train dataset size: </span><span class="si">{</span><span class="n">train_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test dataset size: </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train dataset size: (73309, 32)
Test dataset size: (18328, 32)
</pre></div>
</div>
</div>
</div>
</details>
</section>
</section>
<section id="train-and-test-a-neural-network-model-for-estimating-missing-data">
<h2><span class="section-number">19.1.8. </span>8. Train and test a neural network model for estimating missing data.<a class="headerlink" href="#train-and-test-a-neural-network-model-for-estimating-missing-data" title="Link to this heading">#</a></h2>
<img src="./img/DNN.png" alt="split_data" width="800"/>
<p>Run the next cell to train and test a neural network model for estimating missing PM2.5 values. In this case, you need to train the neural network to learn how PM2.5 values are related to values for all the other pollutants as well as time of day, day of week, and station location. Note that the neural network that you will train is much larger than the one shown on the picture, as it has 64 and 32 units in the two hidden layers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># Define the features you will base your predictions on </span>
<span class="n">pollutants_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PM10&#39;</span><span class="p">,</span><span class="s1">&#39;PM2.5&#39;</span><span class="p">,</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span><span class="s1">&#39;NO2&#39;</span><span class="p">,</span><span class="s1">&#39;NOX&#39;</span><span class="p">,</span><span class="s1">&#39;CO&#39;</span><span class="p">,</span><span class="s1">&#39;OZONE&#39;</span><span class="p">]</span>
<span class="n">pollutants_except_target</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pollutants_list</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">target</span><span class="p">]</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;day_week&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">one_hot</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="n">pollutants_except_target</span>

<span class="c1"># Define the neural network model architecture</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">build_keras_model</span><span class="p">(</span><span class="n">input_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_names</span><span class="p">))</span>

<span class="c1"># Train and test the model</span>
<span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">mae</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">train_and_test_model</span><span class="p">(</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="n">regression_scores</span><span class="p">[</span><span class="s1">&#39;neural_network_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mae</span>
</pre></div>
</div>
</div>
</div>
<p>Compare the <strong>MAE</strong> obtained using the 2 methods. This value has been obtained using the same test set so its comparable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the MAE result</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_score</span> <span class="ow">in</span> <span class="n">regression_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="s1">&#39; : &#39;</span><span class="p">,</span> <span class="n">model_score</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>baseline_model  :  {&#39;MAE&#39;: 8.035857704059362}
neural_network_model  :  {&#39;MAE&#39;: 4.123351311168522}
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-results-from-your-baseline-model-compared-to-the-neural-network">
<h2><span class="section-number">19.1.9. </span>9. Visualize the results from your baseline model compared to the neural network.<a class="headerlink" href="#visualize-the-results-from-your-baseline-model-compared-to-the-neural-network" title="Link to this heading">#</a></h2>
<p>Run the next cell to visualize the results of the baseline model and the neural network model. Use the pulldown menus to choose between different station locations and different “window” or gap sizes in hours. Use the slider to choose the start index of the window you want to investigate. You can also change the <code class="docutils literal notranslate"><span class="pre">start_date</span></code> and <code class="docutils literal notranslate"><span class="pre">end_date</span></code> values to other dates in 2021.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">utils</span><span class="o">.</span><span class="n">create_plot_with_preditions</span><span class="p">(</span><span class="n">data_no_missing</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span>  <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "1cb649234c7446d3958373aa8aacb55c", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="estimate-missing-sensor-measurements-across-all-pollutants">
<h2><span class="section-number">19.1.10. </span>10. Estimate missing sensor measurements across all pollutants.<a class="headerlink" href="#estimate-missing-sensor-measurements-across-all-pollutants" title="Link to this heading">#</a></h2>
<p>With the first line of code below you will estimate missing values for all non-PM2.5 pollutants using the nearest neighbors method. With the second line, you’ll use your neural network next to esimate missing values for PM2.5. The last line simply prints out the number of missing values in each column again, which should be zero if everything went well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># Estimate non-PM2.5 missing values with the nearest neighbor method</span>
<span class="n">imputed_with_baseline_model</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">impute_nontarget_missing_values_interpolate</span><span class="p">(</span><span class="n">raw_data_for_imputing</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="c1"># Estimate missing PM2.5 values with </span>
<span class="n">data_with_imputed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">impute_target_missing_values_neural_network</span><span class="p">(</span><span class="n">raw_data_for_imputing</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">imputed_with_baseline_model</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out a count of missing data for each column in the dataset with imputed values</span>
<span class="n">data_with_imputed</span><span class="p">[</span><span class="n">pollutants_list</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">479/479</span> <span class=" -Color -Color-Green">━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Bold">0s</span> 510us/step
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PM10     0
PM2.5    0
NO       0
NO2      0
NOX      0
CO       0
OZONE    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out a sample of the dataframe</span>
<span class="n">data_with_imputed</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DateTime</th>
      <th>Station</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>PM2.5</th>
      <th>PM10</th>
      <th>NO</th>
      <th>NO2</th>
      <th>NOX</th>
      <th>CO</th>
      <th>OZONE</th>
      <th>PM2.5_imputed_flag</th>
      <th>PM10_imputed_flag</th>
      <th>NO_imputed_flag</th>
      <th>NO2_imputed_flag</th>
      <th>NOX_imputed_flag</th>
      <th>CO_imputed_flag</th>
      <th>OZONE_imputed_flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>33065</th>
      <td>2021-10-10 17:00:00</td>
      <td>TUN</td>
      <td>4.576225</td>
      <td>-74.130956</td>
      <td>25.000000</td>
      <td>33.000000</td>
      <td>8.682000</td>
      <td>32.549000</td>
      <td>41.223000</td>
      <td>0.885700</td>
      <td>19.125000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>38692</th>
      <td>2021-06-02 04:00:00</td>
      <td>LFR</td>
      <td>4.690700</td>
      <td>-74.082483</td>
      <td>9.000000</td>
      <td>18.100000</td>
      <td>19.433000</td>
      <td>9.916000</td>
      <td>29.346000</td>
      <td>0.424180</td>
      <td>0.654000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19985</th>
      <td>2021-04-13 17:00:00</td>
      <td>SUB</td>
      <td>4.761247</td>
      <td>-74.093461</td>
      <td>7.000000</td>
      <td>22.800000</td>
      <td>10.707000</td>
      <td>13.336000</td>
      <td>24.043000</td>
      <td>0.558810</td>
      <td>11.074000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>105345</th>
      <td>2021-01-10 09:00:00</td>
      <td>7MA</td>
      <td>4.645194</td>
      <td>-74.061556</td>
      <td>10.000000</td>
      <td>30.600000</td>
      <td>35.074000</td>
      <td>6.326000</td>
      <td>41.399000</td>
      <td>0.657001</td>
      <td>6.324386</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>138413</th>
      <td>2021-10-20 05:00:00</td>
      <td>COL</td>
      <td>4.737194</td>
      <td>-74.069472</td>
      <td>5.100000</td>
      <td>9.800000</td>
      <td>14.033000</td>
      <td>12.273000</td>
      <td>26.306000</td>
      <td>0.366850</td>
      <td>0.776000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6045</th>
      <td>2021-09-09 21:00:00</td>
      <td>USM</td>
      <td>4.532056</td>
      <td>-74.117139</td>
      <td>10.700000</td>
      <td>37.200000</td>
      <td>9.912000</td>
      <td>16.875000</td>
      <td>26.787000</td>
      <td>0.488460</td>
      <td>3.871000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>99251</th>
      <td>2021-05-01 11:00:00</td>
      <td>JAZ</td>
      <td>4.608500</td>
      <td>-74.114944</td>
      <td>40.300000</td>
      <td>55.700000</td>
      <td>4.670000</td>
      <td>27.892000</td>
      <td>32.562000</td>
      <td>0.800770</td>
      <td>41.334000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>100099</th>
      <td>2021-06-05 19:00:00</td>
      <td>JAZ</td>
      <td>4.608500</td>
      <td>-74.114944</td>
      <td>6.900000</td>
      <td>31.200000</td>
      <td>17.418000</td>
      <td>26.987000</td>
      <td>44.405000</td>
      <td>1.089810</td>
      <td>2.282000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49894</th>
      <td>2021-09-11 22:00:00</td>
      <td>PTE</td>
      <td>4.631767</td>
      <td>-74.117483</td>
      <td>7.700000</td>
      <td>16.800000</td>
      <td>5.488000</td>
      <td>12.818000</td>
      <td>18.306000</td>
      <td>0.804930</td>
      <td>3.127000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>89075</th>
      <td>2021-03-03 11:00:00</td>
      <td>FTB</td>
      <td>4.678242</td>
      <td>-74.143819</td>
      <td>25.300000</td>
      <td>49.600000</td>
      <td>7.331000</td>
      <td>16.025000</td>
      <td>23.352000</td>
      <td>0.527970</td>
      <td>33.164000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>109874</th>
      <td>2021-07-18 02:00:00</td>
      <td>7MA</td>
      <td>4.645194</td>
      <td>-74.061556</td>
      <td>6.000000</td>
      <td>32.900000</td>
      <td>69.494000</td>
      <td>3.476000</td>
      <td>72.970000</td>
      <td>1.220743</td>
      <td>5.791040</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>30762</th>
      <td>2021-07-06 18:00:00</td>
      <td>TUN</td>
      <td>4.576225</td>
      <td>-74.130956</td>
      <td>6.000000</td>
      <td>10.000000</td>
      <td>3.322000</td>
      <td>9.219000</td>
      <td>12.539000</td>
      <td>0.526790</td>
      <td>7.754000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24507</th>
      <td>2021-10-19 03:00:00</td>
      <td>SUB</td>
      <td>4.761247</td>
      <td>-74.093461</td>
      <td>8.000000</td>
      <td>25.500000</td>
      <td>6.315000</td>
      <td>15.716000</td>
      <td>22.031000</td>
      <td>0.427810</td>
      <td>1.257000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>51983</th>
      <td>2021-12-07 23:00:00</td>
      <td>PTE</td>
      <td>4.631767</td>
      <td>-74.117483</td>
      <td>25.100000</td>
      <td>20.125213</td>
      <td>16.826000</td>
      <td>20.544000</td>
      <td>37.370000</td>
      <td>0.998150</td>
      <td>0.884000</td>
      <td>None</td>
      <td>interpolated</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5207</th>
      <td>2021-08-05 23:00:00</td>
      <td>USM</td>
      <td>4.532056</td>
      <td>-74.117139</td>
      <td>6.900000</td>
      <td>25.000000</td>
      <td>2.159000</td>
      <td>13.099000</td>
      <td>15.258000</td>
      <td>0.350980</td>
      <td>12.117000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>129542</th>
      <td>2021-10-15 14:00:00</td>
      <td>GYR</td>
      <td>4.783750</td>
      <td>-74.044139</td>
      <td>7.000000</td>
      <td>15.000000</td>
      <td>1.729000</td>
      <td>5.255000</td>
      <td>6.982000</td>
      <td>0.111900</td>
      <td>42.421000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>117467</th>
      <td>2021-05-30 11:00:00</td>
      <td>CSE</td>
      <td>4.595833</td>
      <td>-74.148500</td>
      <td>38.000000</td>
      <td>53.000000</td>
      <td>110.467756</td>
      <td>9.440776</td>
      <td>119.908448</td>
      <td>2.644980</td>
      <td>8.854000</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
      <td>interpolated</td>
      <td>interpolated</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>111865</th>
      <td>2021-10-09 01:00:00</td>
      <td>7MA</td>
      <td>4.645194</td>
      <td>-74.061556</td>
      <td>20.700000</td>
      <td>33.800000</td>
      <td>74.008000</td>
      <td>7.756000</td>
      <td>81.764000</td>
      <td>1.127240</td>
      <td>5.556576</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>2021-05-08 17:00:00</td>
      <td>USM</td>
      <td>4.532056</td>
      <td>-74.117139</td>
      <td>23.600000</td>
      <td>48.400000</td>
      <td>3.839000</td>
      <td>20.626000</td>
      <td>24.465000</td>
      <td>0.674370</td>
      <td>9.013977</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>13374</th>
      <td>2021-07-12 06:00:00</td>
      <td>BOL</td>
      <td>4.735806</td>
      <td>-74.125889</td>
      <td>8.000000</td>
      <td>8.900000</td>
      <td>6.703000</td>
      <td>19.382000</td>
      <td>26.086000</td>
      <td>0.211430</td>
      <td>3.526014</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>75295</th>
      <td>2021-08-06 07:00:00</td>
      <td>CDAR</td>
      <td>4.658467</td>
      <td>-74.083967</td>
      <td>21.000000</td>
      <td>19.684615</td>
      <td>53.848000</td>
      <td>27.503000</td>
      <td>81.352000</td>
      <td>1.303020</td>
      <td>2.835000</td>
      <td>None</td>
      <td>interpolated</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49560</th>
      <td>2021-08-29 00:00:00</td>
      <td>PTE</td>
      <td>4.631767</td>
      <td>-74.117483</td>
      <td>24.108313</td>
      <td>40.500000</td>
      <td>19.025000</td>
      <td>16.175000</td>
      <td>35.173000</td>
      <td>1.069140</td>
      <td>13.625087</td>
      <td>neural network</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>interpolated</td>
    </tr>
    <tr>
      <th>50770</th>
      <td>2021-10-18 10:00:00</td>
      <td>PTE</td>
      <td>4.631767</td>
      <td>-74.117483</td>
      <td>32.800000</td>
      <td>47.000000</td>
      <td>9.494000</td>
      <td>18.360000</td>
      <td>27.854000</td>
      <td>0.551490</td>
      <td>14.401000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>77418</th>
      <td>2021-11-02 18:00:00</td>
      <td>CDAR</td>
      <td>4.658467</td>
      <td>-74.083967</td>
      <td>21.000000</td>
      <td>21.000000</td>
      <td>6.254000</td>
      <td>19.916000</td>
      <td>26.171000</td>
      <td>0.689010</td>
      <td>6.174000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15354</th>
      <td>2021-10-02 18:00:00</td>
      <td>BOL</td>
      <td>4.735806</td>
      <td>-74.125889</td>
      <td>4.700000</td>
      <td>37.200000</td>
      <td>10.965000</td>
      <td>25.727000</td>
      <td>36.693000</td>
      <td>0.650100</td>
      <td>5.270000</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You can see that the flag columns include different values: <code class="docutils literal notranslate"><span class="pre">None</span></code> where there is original data, <code class="docutils literal notranslate"><span class="pre">'neural</span> <span class="pre">network'</span></code> where the values were imputed with the neural network and <code class="docutils literal notranslate"><span class="pre">'interpolated'</span></code> where the values were interpolated.</p>
</section>
<section id="visualize-the-results-of-filling-in-missing-pm2-5-values">
<h2><span class="section-number">19.1.11. </span>11. Visualize the results of filling in missing PM2.5 values<a class="headerlink" href="#visualize-the-results-of-filling-in-missing-pm2-5-values" title="Link to this heading">#</a></h2>
<p>You can use the flag columns you recorded above to distinguish between original and estimated data, and you can visualize this by running the cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a start and end date and visualize missing values that have been imputed</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">create_time_series_plot</span><span class="p">(</span><span class="n">data_with_imputed</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "c67d2e4bfcdb4463bdb6c4f3094558b2", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="optional-write-the-resulting-dataset-to-a-new-csv-file">
<h2><span class="section-number">19.1.12. </span>12. Optional: write the resulting dataset to a new csv file<a class="headerlink" href="#optional-write-the-resulting-dataset-to-a-new-csv-file" title="Link to this heading">#</a></h2>
<p>Finally, you can save the data to a new csv file for use in the next stage of the project. In this case, the data will be provided to you in the next lab so you don’t need to save it here, but we’ve included the line of code below to show you how you can write the data to file. If you uncomment the code below (remove the #) you can run the cell and then click on the Jupyter icon above to see the new csv file in your folder with the rest of the lab contents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data_with_imputed.to_csv(&#39;full_data_with_imputed_values.csv&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./parts\part10\C1\AirQualityDesignPhase"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../chapter.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">19. </span>Applications and Sensors</p>
      </div>
    </a>
    <a class="right-next"
       href="../../C2/chapter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">20. </span>Chapter Title</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">19.1.1. Import Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">19.1.2. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-location-latitude-and-longitude-of-sensor-stations-to-the-dataframe">19.1.3. Add location (latitude and longitude of sensor stations) to the dataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-extent-and-distribution-of-missing-data">19.1.4. Visualize the extent and distribution of missing data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-null-values">19.1.4.1. 4.1 Count null values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-missing-data-in-a-time-series">19.1.4.2. 4.2 Visualize missing data in a time series</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-distribution-of-gaps-in-the-data">19.1.4.3. 4.3 Visualize the distribution of gaps in the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-simple-methods-for-estimating-missing-values">19.1.5. Visualize simple methods for estimating missing values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-nearest-neighbor-method-to-establish-a-baseline">19.1.6. 6. Run the nearest neighbor method to establish a baseline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-data-to-train-a-neural-network-model">19.1.7. 7. Prepare the data to train a neural network model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-missing-values-and-add-columns-for-later-use-with-a-neural-network-model">19.1.7.1. 7.1. Remove missing values and add columns for later use with a neural network model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data-into-training-and-testing-sets">19.1.7.2. 7.2 Split data into training and testing sets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-and-test-a-neural-network-model-for-estimating-missing-data">19.1.8. 8. Train and test a neural network model for estimating missing data.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results-from-your-baseline-model-compared-to-the-neural-network">19.1.9. 9. Visualize the results from your baseline model compared to the neural network.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-missing-sensor-measurements-across-all-pollutants">19.1.10. 10. Estimate missing sensor measurements across all pollutants.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-results-of-filling-in-missing-pm2-5-values">19.1.11. 11. Visualize the results of filling in missing PM2.5 values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-write-the-resulting-dataset-to-a-new-csv-file">19.1.12. 12. Optional: write the resulting dataset to a new csv file</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Charith Perera
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  "<script src='./static/semantic/semantic.min.js'></script>"

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>